import React, { useState, useEffect, useRef } from 'react';
import { 
  MapPin, Phone, Calendar, CheckSquare, Edit3, Home, Plane, Sun, 
  Umbrella, Camera, Coffee, ShoppingBag, Utensils, AlertCircle, 
  Share2, X, Play, Hotel, CreditCard, Ship, Waves, User, LayoutGrid
} from 'lucide-react';

const App = () => {
  // --- ìƒíƒœ ê´€ë¦¬ (State) ---
  const [activeTab, setActiveTab] = useState('itinerary');
  const [dDayLabel, setDDayLabel] = useState('');
  const [selectedDay, setSelectedDay] = useState(0);
  const [showVideo, setShowVideo] = useState(false);
  const [videoUrl, setVideoUrl] = useState('');
  const [showToast, setShowToast] = useState(false);

  // ë°ì´í„° ì €ì¥ì†Œ (LocalStorage)
  const STORAGE_KEY_MEMO = 'tm_taenggu_memo_v1';
  const STORAGE_KEY_CHECKLIST = 'tm_taenggu_checklist_v1';

  const [userMemo, setUserMemo] = useState('');
  const [checklistState, setChecklistState] = useState({}); // { "ì—¬ê¶Œ...": true, "ìˆ˜ì˜ë³µ...": false }

  // ì—¬í–‰ ì‹œì‘ì¼
  const TRAVEL_START_DATE = new Date('2025-12-20');

  // --- ì´ˆê¸°í™” ë° íš¨ê³¼ (Effects) ---
  useEffect(() => {
    // 1. ì €ì¥ëœ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
    const savedMemo = localStorage.getItem(STORAGE_KEY_MEMO);
    const savedChecklist = localStorage.getItem(STORAGE_KEY_CHECKLIST);

    if (savedMemo) setUserMemo(savedMemo);
    if (savedChecklist) setChecklistState(JSON.parse(savedChecklist));

    // 2. D-Day ê³„ì‚°
    const today = new Date();
    // ì‹œê°„ì°¨ ì œê±°ë¥¼ ìœ„í•´ ë‚ ì§œë§Œ ë¹„êµ
    const start = new Date(TRAVEL_START_DATE.getFullYear(), TRAVEL_START_DATE.getMonth(), TRAVEL_START_DATE.getDate());
    const now = new Date(today.getFullYear(), today.getMonth(), today.getDate());
    
    const diffTime = start - now;
    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)); 

    if (diffDays > 0) setDDayLabel(`D-${diffDays} ì„¤ë ˜ê°€ë“!`);
    else if (diffDays === 0) setDDayLabel('D-Day ì—¬í–‰ì‹œì‘!');
    else setDDayLabel(`ì—¬í–‰ ${Math.abs(diffDays) + 1}ì¼ì°¨`);
  }, []);

  // --- í•¸ë“¤ëŸ¬ í•¨ìˆ˜ ---

  // ë©”ëª¨ ì €ì¥
  const handleMemoChange = (e) => {
    const text = e.target.value;
    setUserMemo(text);
    localStorage.setItem(STORAGE_KEY_MEMO, text);
  };

  // ì²´í¬ë¦¬ìŠ¤íŠ¸ í† ê¸€
  const toggleCheck = (itemText) => {
    const newState = { ...checklistState, [itemText]: !checklistState[itemText] };
    setChecklistState(newState);
    localStorage.setItem(STORAGE_KEY_CHECKLIST, JSON.stringify(newState));
  };

  // ì²´í¬ë¦¬ìŠ¤íŠ¸ ì „ì²´ ì„ íƒ/í•´ì œ
  const checkAll = (items) => {
    const newState = { ...checklistState };
    items.forEach(item => newState[item] = true);
    setChecklistState(newState);
    localStorage.setItem(STORAGE_KEY_CHECKLIST, JSON.stringify(newState));
  };

  const resetChecklist = () => {
    if(window.confirm('ì²´í¬ë¦¬ìŠ¤íŠ¸ë¥¼ ì´ˆê¸°í™” í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
      setChecklistState({});
      localStorage.removeItem(STORAGE_KEY_CHECKLIST);
    }
  };

  // ê³µìœ í•˜ê¸°
  const handleShare = () => {
    // ì‹¤ì œ ë°°í¬ëœ URLì„ ë³µì‚¬í•˜ê±°ë‚˜ í˜„ì¬ URL ë³µì‚¬
    navigator.clipboard.writeText(window.location.href);
    setShowToast(true);
    setTimeout(() => setShowToast(false), 2000);
  };

  // ë¹„ë””ì˜¤ ëª¨ë‹¬
  const openVideo = (id) => {
    setVideoUrl(`https://www.youtube.com/embed/${id}?autoplay=1`);
    setShowVideo(true);
  };

  // íƒ­ ë³€ê²½ ì‹œ ìŠ¤í¬ë¡¤ ì¡°ì •
  const handleTabChange = (tab) => {
    setActiveTab(tab);
    // íƒ­ ë‚´ìš©ì´ ì‹œì‘ë˜ëŠ” ìœ„ì¹˜ë¡œ ë¶€ë“œëŸ½ê²Œ ìŠ¤í¬ë¡¤ (í—¤ë” ë†’ì´ ê³ ë ¤)
    const contentStart = document.getElementById('tab-content-start');
    if (contentStart) {
      window.scrollTo({
        top: contentStart.offsetTop - 120, // íƒ­ ë†’ì´ ë³´ì •
        behavior: 'smooth'
      });
    }
  };

  // --- ë°ì´í„° ì •ì˜ ---
  const tripData = [
    {
      day: "D1", date: "12/20 (ê¸ˆ)", title: "ë‚˜íŠ¸ë‘ ë„ì°© & ì ì‘",
      items: [
        { time: "ì¶œë°œ", title: "ì²­ì£¼ê³µí•­ (ì—ì–´ë¡œì¼€ì´)", desc: "ì—¬ê¶Œ, ì•„ì´ ê°„ì‹, ìœ ëª¨ì°¨ ì±™ê¸°ê¸°", icon: Plane },
        { time: "ë„ì°©", title: "ë‚˜íŠ¸ë‘ ê¹œë€ ê³µí•­", desc: "ì…êµ­ì‹¬ì‚¬ â†’ ì§ ì°¾ê¸° â†’ ê·¸ë©/í”½ì—…ì°¨ëŸ‰", icon: MapPin },
        { time: "ìˆ™ì†Œ", title: "ë ˆê°ˆë¦¬ì•„ ê³¨ë“œ ì²´í¬ì¸", desc: "ì‹œë‚´ ì¤‘ì‹¬, ì§ í’€ê³  ê°€ë³ê²Œ í¸ì˜ì ", icon: Hotel }
      ]
    },
    {
      day: "D2", date: "12/21 (í† )", title: "ì‹œë‚´ íƒë°© & ì‡¼í•‘",
      items: [
        { time: "ì˜¤ì „", title: "í™˜ì „ & ìŒ€êµ­ìˆ˜", desc: "ê¹€ì²­/ê¹€ë¹ˆ í™˜ì „ â†’ í˜„ì§€ ìŒ€êµ­ìˆ˜ ë§›ì§‘", icon: CreditCard },
        { time: "ì˜¤í›„", title: "ë¡¯ë°ë§ˆíŠ¸ ì‡¼í•‘", desc: "ë¬¼, ë§¥ì£¼, ê¸°ë…í’ˆ, ì•„ì´ ê°„ì‹ ëŒ€ëŸ‰ êµ¬ë§¤", icon: ShoppingBag },
        { time: "íœ´ì‹", title: "ì½©ì¹´í˜", desc: "ì½”ì½”ë„› ìŠ¤ë¬´ë”” ì»¤í”¼ & íœ´ì‹", icon: Coffee }
      ]
    },
    {
      day: "D3", date: "12/22 (ì¼)", title: "ë¹ˆì›ë”ìŠ¤ ë°ì´",
      items: [
        { time: "ì´ë™", title: "ì¼€ì´ë¸”ì¹´/ë³´íŠ¸", desc: "ì„¬ìœ¼ë¡œ ì´ë™ (ì˜¤í”ˆëŸ° ì¶”ì²œ)", icon: Ship },
        { time: "ì˜¤ì „", title: "ì‚¬íŒŒë¦¬ & ë™ë¬¼ì›", desc: "ì„±ë¹ˆì´ ì·¨í–¥ì €ê²© ë™ë¬¼ êµ¬ê²½", icon: Camera },
        { time: "ì˜¤í›„", title: "ì›Œí„°íŒŒí¬", desc: "ìœ ìˆ˜í’€, íŒŒë„í’€ (ìˆ˜ì˜ë³µ ì§€ì°¸)", icon: Waves }
      ],
      video: { id: "y7jw_15MbOU", label: "ğŸ¬ ë¹ˆì›ë”ìŠ¤ ë¯¸ë¦¬ë³´ê¸° (ì˜ìƒ)" }
    },
    {
      day: "D4", date: "12/23 (ì›”)", title: "ë¨¸ë“œì˜¨ì²œ & ë¦¬ì¡°íŠ¸ ì´ë™",
      items: [
        { time: "11:00", title: "ë ˆê°ˆë¦¬ì•„ ì²´í¬ì•„ì›ƒ", desc: "ì§ ë³´ê´€ í›„ ì´ë™", icon: LayoutGrid },
        { time: "ì˜¤í›„", title: "ì•„ì´ë¦¬ì¡°íŠ¸ ë¨¸ë“œì˜¨ì²œ", desc: "ë”°ëœ»í•œ ë¨¸ë“œ ìŠ¤íŒŒ & ë¬¼ë†€ì´", icon: Sun },
        { time: "15:00", title: "ì•„ë¯¸ì•„ë‚˜ ë¦¬ì¡°íŠ¸ ì²´í¬ì¸", desc: "ê¹œë€ ì§€ì—­ ì´ë™, íœ´ì–‘ ì‹œì‘!", icon: Umbrella }
      ]
    },
    {
      day: "D5", date: "12/24 (í™”)", title: "ë¦¬ì¡°íŠ¸ ì½• (í¬ë¦¬ìŠ¤ë§ˆìŠ¤ ì´ë¸Œ)",
      items: [
        { time: "ì „ì¼", title: "ìˆ˜ì˜ì¥ & í”„ë¼ì´ë¹— ë¹„ì¹˜", desc: "ëª¨ë˜ë†€ì´, ìŠ¤ë…¸í´ë§ ë§›ë³´ê¸°", icon: Waves },
        { time: "í‚¤ì¦ˆ", title: "í‚¤ì¦ˆí´ëŸ½ í”„ë¡œê·¸ë¨", desc: "ì‹œê°„í‘œ í™•ì¸ í›„ ì°¸ì—¬", icon: User },
        { time: "ì €ë…", title: "ë¦¬ì¡°íŠ¸ ë””ë„ˆ", desc: "ì´ë¸Œ ê¸°ë… ì—¬ìœ ë¡œìš´ ì‹ì‚¬", icon: Utensils }
      ]
    },
    {
      day: "D6", date: "12/25 (ìˆ˜)", title: "ì²´í¬ì•„ì›ƒ & ê·€êµ­ ì¤€ë¹„",
      items: [
        { time: "ì˜¤ì „", title: "ì¡°ì‹ & ë§ˆì§€ë§‰ ìˆ˜ì˜", desc: "ì•„ì‰¬ì›€ ë‹¬ë˜ê¸°", icon: Coffee },
        { time: "12:00", title: "ì²´í¬ì•„ì›ƒ", desc: "ì§ ë§¡ê¸°ê³  ì‹œë‚´ ë§ˆì‚¬ì§€ or ê³µí•­ ìƒŒë”©", icon: LayoutGrid },
        { time: "ì €ë…", title: "ê³µí•­ ì´ë™", desc: "ì¶œêµ­ ì‹¬ì‚¬ (ì‚¬ëŒ ë§ìŒ ì£¼ì˜)", icon: Plane }
      ]
    }
  ];

  const checklistData = {
    "í•„ìˆ˜": ["ì—¬ê¶Œ (ìœ íš¨ê¸°ê°„ 6ê°œì›”â†‘)", "í•­ê³µê¶Œ E-ticket", "í˜¸í…” ë°”ìš°ì²˜ (ìº¡ì²˜)", "ì§€ê°‘/í˜„ê¸ˆ(ë‹¬ëŸ¬)/ì¹´ë“œ", "ìœ ì‹¬/ì´ì‹¬"],
    "ì•„ì´ìš©í’ˆ": ["ë¹„ìƒì•½ (í•´ì—´ì œ/ë°´ë“œ)", "ìˆ˜ì˜ë³µ/ë˜ì‰¬ê°€ë“œ (2ë²Œ)", "íŠœë¸Œ/ì•”ë§", "ì„ í¬ë¦¼/ëª¨ì/ì„ ê¸€ë¼ìŠ¤", "ì–‡ì€ ê²‰ì˜· (ì—ì–´ì»¨ ëŒ€ë¹„)", "ì¥ë‚œê°/ìŠ¤í‹°ì»¤ë¶ (ê¸°ë‚´ìš©)"],
    "ê¸°íƒ€": ["ìƒ¤ì›Œê¸° í•„í„° (í•„ìˆ˜!)", "ì¶©ì „ê¸°/ë³´ì¡°ë°°í„°ë¦¬", "ë¬¼í‹°ìŠˆ/íœ´ì§€", "íœ´ëŒ€ìš© ì„ í’ê¸°"]
  };

  // --- ë Œë”ë§ ---
  return (
    <div className="min-h-screen bg-slate-50 font-sans text-slate-800 pb-20 selection:bg-teal-100">
      
      {/* 1. Header */}
      <header className="bg-white/95 backdrop-blur-md border-b border-slate-100 sticky top-0 z-40 transition-all duration-300">
        <div className="max-w-md mx-auto px-4 h-14 flex items-center justify-between">
          <div className="flex items-center gap-2 cursor-pointer" onClick={() => window.scrollTo({top:0, behavior:'smooth'})}>
            <img 
              src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgHfgIX70O5k6Anuo0UgALIdaG9jSga9auHu3uyz0uEirylGPAJnjN_qQbvEGMUvPqUQf_g9FMNUHRxlDcUBf4vZ3Mpy4TnA9WxbmzWYK11gt2zuy_Irl4wctNFjcjLyPo0GPXV792o_J7L9guRMuDfeC1gy7USwywjYbECZgzcsHybuGRRAXAnO1eNmP8/s320/logo.png" 
              alt="íˆ¬ì–´ë©”ì´ì»¤ ë¡œê³ " 
              className="h-8 w-auto hover:opacity-80 transition-opacity" 
            />
            <div className="leading-tight">
              <p className="text-[11px] font-bold text-slate-900 tracking-tight">Smart Guidebook</p>
              <p className="text-[10px] text-slate-500 font-medium">Family Trip</p>
            </div>
          </div>
          <button onClick={handleShare} className="bg-slate-100 hover:bg-slate-200 text-slate-700 px-3 py-1.5 rounded-full text-xs font-bold transition flex items-center gap-1.5">
            <Share2 size={12} /> ê³µìœ 
          </button>
        </div>
      </header>

      <main className="max-w-md mx-auto bg-white min-h-screen shadow-2xl overflow-hidden relative">
        
        {/* 2. Hero Section */}
        <section className="relative h-[65vh] flex items-center justify-center text-center text-white overflow-hidden">
          {/* Background Image */}
          <div className="absolute inset-0 z-0">
            <img 
              src="https://www.agoda.com/wp-content/uploads/2024/08/Nha-Trang.jpg" 
              alt="Nha Trang" 
              className="w-full h-full object-cover"
            />
            <div className="absolute inset-0 bg-gradient-to-t from-slate-900/90 via-slate-900/30 to-slate-900/20"></div>
          </div>

          <div className="relative z-10 px-6 py-10 flex flex-col items-center w-full">
            {/* D-Day Badge */}
            <div className="mb-4 animate-bounce">
              <span className="bg-red-500 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg border border-red-400">
                {dDayLabel}
              </span>
            </div>

            <h1 className="text-4xl font-black mb-3 leading-tight drop-shadow-2xl">
              íƒ±êµ¬ë„¤ ê°€ì¡±ì˜<br />
              <span className="text-teal-300">ë‚˜íŠ¸ë‘ íë§ ì—¬í–‰</span> ğŸŒ´
            </h1>
            
            <p className="text-sm text-white/90 max-w-lg mx-auto leading-relaxed mb-8 font-light">
              12.20 - 12.26 (5ë°• 7ì¼)<br/>
              ì‹œë‚´ 3ë°• + ë¦¬ì¡°íŠ¸ 2ë°•
            </p>

            {/* Key Info Grid */}
            <div className="grid grid-cols-3 gap-2 w-full">
              <InfoBox icon={<User size={18} />} label="ë©¤ë²„" value="ì„±ë¹ˆì´ë„¤" />
              <InfoBox icon={<Plane size={18} />} label="í•­ê³µ" value="ì²­ì£¼(ì—ì–´ë¡œì¼€ì´)" />
              <InfoBox icon={<Sun size={18} />} label="ë‚ ì”¨" value="22Â° / 29Â°" />
            </div>
          </div>
        </section>

        {/* 3. Sticky Navigation Tabs */}
        <section className="sticky top-14 z-30 bg-white border-b border-slate-200 shadow-sm">
          <div className="flex text-sm font-bold text-slate-400">
            <TabButton active={activeTab === 'itinerary'} onClick={() => handleTabChange('itinerary')} label="ì¼ì •" />
            <TabButton active={activeTab === 'hotels'} onClick={() => handleTabChange('hotels')} label="ìˆ™ì†Œ" />
            <TabButton active={activeTab === 'checklist'} onClick={() => handleTabChange('checklist')} label="ì¤€ë¹„ë¬¼" />
            <TabButton active={activeTab === 'contacts'} onClick={() => handleTabChange('contacts')} label="ì—°ë½ì²˜/ë©”ëª¨" />
          </div>
        </section>

        {/* 4. Content Sections */}
        <section id="tab-content-start" className="bg-slate-50 min-h-[60vh] pb-10">
          
          {/* TAB 1: Itinerary */}
          {activeTab === 'itinerary' && (
            <div className="p-5 animate-fade-in">
              <div className="flex items-center justify-between mb-4">
                <h2 className="text-xl font-bold text-slate-900 flex items-center gap-2">
                  <Calendar className="text-teal-600" size={20} /> ìƒì„¸ ì¼ì •
                </h2>
                <span className="text-[10px] text-slate-500 bg-white px-2 py-1 rounded border">ë‚ ì§œ ì„ íƒ â†”</span>
              </div>

              {/* Day Selector (Horizontal Scroll) */}
              <div className="flex gap-2 overflow-x-auto pb-4 no-scrollbar">
                {tripData.map((data, idx) => (
                  <button
                    key={idx}
                    onClick={() => setSelectedDay(idx)}
                    className={`flex-shrink-0 flex flex-col items-center justify-center py-2 px-4 rounded-xl border transition-all ${
                      selectedDay === idx 
                        ? 'bg-teal-600 text-white border-teal-600 shadow-lg scale-105' 
                        : 'bg-white text-slate-500 border-slate-200 hover:bg-slate-50'
                    }`}
                  >
                    <span className="text-xs font-bold">{data.day}</span>
                    <span className="text-[10px] whitespace-nowrap opacity-80">{data.date.split(' ')[0]}</span>
                  </button>
                ))}
              </div>

              {/* Timeline */}
              <div className="mt-2">
                 <div className="mb-5 px-1">
                    <h3 className="text-lg font-black text-slate-800">
                      {tripData[selectedDay].day} <span className="text-teal-600 font-medium ml-2 text-sm">{tripData[selectedDay].date}</span>
                    </h3>
                    <p className="text-slate-500 text-sm mt-1">"{tripData[selectedDay].title}"</p>
                    
                    {tripData[selectedDay].video && (
                      <button 
                        onClick={() => openVideo(tripData[selectedDay].video.id)}
                        className="w-full mt-3 flex items-center justify-center gap-2 bg-slate-800 text-white py-3 rounded-xl font-bold shadow-md hover:bg-slate-700 transition"
                      >
                        {tripData[selectedDay].video.label} <Play size={16} fill="white" className="text-red-500" />
                      </button>
                    )}
                 </div>

                 <div className="space-y-6 relative pl-4 before:absolute before:inset-y-0 before:left-[1.35rem] before:w-[2px] before:bg-slate-200">
                    {tripData[selectedDay].items.map((item, i) => (
                      <div key={i} className="relative pl-8">
                        <div className="absolute left-0 top-1 w-6 h-6 rounded-full bg-white border-2 border-teal-500 flex items-center justify-center z-10 shadow-sm text-teal-600">
                          <item.icon size={12} />
                        </div>
                        <div className="bg-white p-4 rounded-xl border border-slate-100 shadow-sm hover:shadow-md transition-shadow">
                          <div className="flex justify-between items-start mb-1">
                            <h4 className="font-bold text-slate-800 text-base">{item.title}</h4>
                            <span className="text-[10px] font-bold text-slate-500 bg-slate-100 px-2 py-0.5 rounded ml-2 whitespace-nowrap">{item.time}</span>
                          </div>
                          <p className="text-sm text-slate-500 leading-relaxed">{item.desc}</p>
                        </div>
                      </div>
                    ))}
                 </div>
              </div>

              {/* Honey Tip */}
              <div className="mt-8 bg-amber-50 border border-amber-100 rounded-2xl p-5 shadow-sm">
                <h3 className="font-bold text-amber-800 text-sm mb-3 flex items-center gap-2">
                    <AlertCircle size={16} className="text-amber-500" /> íˆ¬ì–´ë©”ì´ì»¤ì˜ ê¿€íŒ
                </h3>
                <ul className="space-y-2 text-xs md:text-sm text-slate-700">
                    <li className="flex gap-2 items-start"><span className="text-amber-500">âœ”</span> <div><b>ì²­ì£¼ê³µí•­:</b> ì£¼ì°¨ì¥ì´ ë§Œì°¨ì¼ í™•ë¥ ì´ ë†’ìœ¼ë‹ˆ ì—¬ìœ ë¡­ê²Œ ë„ì°©í•˜ì„¸ìš”. (ì—ì–´ë¡œì¼€ì´ ìˆ˜ì† ì¹´ìš´í„° í™•ì¸ í•„ìˆ˜)</div></li>
                    <li className="flex gap-2 items-start"><span className="text-amber-500">âœ”</span> <div><b>ë¹ˆì›ë”ìŠ¤:</b> ì›Œí„°íŒŒí¬ìš© ê°œì¸ íƒ€ì›” í•„ìˆ˜! í˜¸í…” ë¹„ì¹˜íƒ€ì›” ë¹Œë ¤ê°€ì„¸ìš”.</div></li>
                    <li className="flex gap-2 items-start"><span className="text-amber-500">âœ”</span> <div><b>ë¬¼ê°ˆì´ ì£¼ì˜:</b> ì–‘ì¹˜ëŠ” ìƒìˆ˜ë¡œ, ì‹ë‹¹ ì–¼ìŒì€ 'ê°€ìš´ë° êµ¬ë© ëš«ë¦°' ì œë¹™ê¸° ì–¼ìŒë§Œ.</div></li>
                </ul>
              </div>
            </div>
          )}

          {/* TAB 2: Hotels */}
          {activeTab === 'hotels' && (
            <div className="p-5 space-y-6 animate-fade-in">
              <HotelCard 
                name="ë ˆê°ˆë¦¬ì•„ ê³¨ë“œ í˜¸í…”" 
                badge="1~3ì¼ì°¨ (3ë°•)" 
                room="Superior With Window Â· ê°ì‹¤ 1"
                checkin="12/20 (ê¸ˆ)"
                checkout="12/23 (ì›”)"
                address="39 - 41 Nguyen Thi Minh Khai Street, Tan Lap"
                img="https://tse4.mm.bing.net/th/id/OIP.guebFjtIEj9uw8fcCl-B6gHaFj?cb=ucfimg2&ucfimg=1&w=474&h=379&c=7&p=0"
                mapLink="https://www.google.com/maps/search/?api=1&query=Kh%C3%A1ch%20S%E1%BA%A1n%20Regalia%20Gold%20Nha%20Trang"
                tel="+842583599999"
              />
              <HotelCard 
                name="ì•„ë¯¸ì•„ë‚˜ ë¦¬ì¡°íŠ¸ (ê¹œë€)" 
                badge="4~5ì¼ì°¨ (2ë°•)" 
                badgeColor="bg-teal-600"
                room="Deluxe Twin Room Sea View"
                checkin="12/23 (ì›”)"
                checkout="12/25 (ìˆ˜)"
                address="Khu nghá»‰ dÆ°á»¡ng Amiana Cam Ranh"
                img="https://tse2.mm.bing.net/th/id/OIP.G8D88PDmhOCiky30vbNNkgHaFj?cb=ucfimg2&ucfimg=1&w=474&h=379&c=7&p=0"
                mapLink="https://www.google.com/maps/search/?api=1&query=Khu%20nghi%20d%C6%B0%E1%BB%A1ng%20Amiana%20Cam%20Ranh"
                tel="+842583993333"
                extraInfo="ì¡°ì‹/ì„ì‹ í¬í•¨ (ì•„ë™ ì„±ë¹ˆì´ ë™ë°˜ ì²´í¬ í•„ìš”)"
              />
            </div>
          )}

          {/* TAB 3: Checklist */}
          {activeTab === 'checklist' && (
            <div className="p-5 animate-fade-in">
              <div className="bg-white rounded-2xl shadow-sm border border-slate-100 p-5 sticky top-28 z-20 mb-6">
                 <div className="flex justify-between items-center mb-2">
                     <h2 className="font-bold text-slate-800 flex items-center gap-2"><CheckSquare size={18} className="text-teal-600"/> ì¤€ë¹„ë¬¼ ì²´í¬</h2>
                     <span className="text-xs font-bold text-teal-600">
                       {Math.round((Object.values(checklistState).filter(Boolean).length / Object.values(checklistData).flat().length) * 100) || 0}% ì™„ë£Œ
                     </span>
                 </div>
                 <div className="w-full bg-slate-100 rounded-full h-2.5 mb-4 overflow-hidden">
                    <div 
                      className="bg-teal-500 h-2.5 rounded-full transition-all duration-500" 
                      style={{width: `${Math.round((Object.values(checklistState).filter(Boolean).length / Object.values(checklistData).flat().length) * 100) || 0}%`}}
                    ></div>
                 </div>
                 <div className="flex gap-2">
                     <button onClick={resetChecklist} className="text-xs bg-slate-100 text-slate-600 px-3 py-2 rounded-lg flex-1 font-medium hover:bg-slate-200">ì´ˆê¸°í™”</button>
                     <button onClick={() => checkAll(Object.values(checklistData).flat())} className="text-xs bg-teal-50 text-teal-700 px-3 py-2 rounded-lg flex-1 font-bold hover:bg-teal-100">ëª¨ë‘ ì²´í¬</button>
                 </div>
              </div>

              <div className="space-y-6 pb-10">
                {Object.entries(checklistData).map(([category, items]) => (
                  <div key={category}>
                    <h4 className="font-bold text-slate-800 mb-2 px-1 border-l-4 border-teal-500 pl-2">{category}</h4>
                    <div className="bg-white rounded-xl border border-slate-100 divide-y divide-slate-50 overflow-hidden">
                      {items.map(item => (
                        <div 
                          key={item} 
                          onClick={() => toggleCheck(item)}
                          className={`flex items-center p-3 cursor-pointer transition-colors ${checklistState[item] ? 'bg-slate-50' : 'hover:bg-slate-50'}`}
                        >
                          <div className={`w-5 h-5 rounded border flex items-center justify-center mr-3 transition-colors ${checklistState[item] ? 'bg-teal-500 border-teal-500' : 'border-slate-300'}`}>
                            {checklistState[item] && <CheckSquare size={12} className="text-white" />}
                          </div>
                          <span className={`text-sm flex-1 ${checklistState[item] ? 'text-slate-400 line-through' : 'text-slate-700'}`}>{item}</span>
                        </div>
                      ))}
                    </div>
                  </div>
                ))}
              </div>
            </div>
          )}

          {/* TAB 4: Contacts & Memo */}
          {activeTab === 'contacts' && (
            <div className="p-5 animate-fade-in space-y-6">
               {/* Emergency Contact */}
               <div className="bg-white rounded-2xl p-6 border border-slate-100 shadow-sm text-center">
                   <p className="text-xs font-bold text-slate-400 mb-2 tracking-widest">EMERGENCY CONTACT</p>
                   <div className="w-20 h-20 bg-slate-100 rounded-full mx-auto mb-3 flex items-center justify-center text-3xl shadow-inner">ğŸ‘¨ğŸ»</div>
                   <h3 className="text-xl font-bold text-slate-900">ë‚¨í¸ íƒ±êµ¬</h3>
                   <p className="text-slate-500 text-sm mb-4">010-9443-7881</p>
                   <a href="tel:01094437881" className="flex items-center justify-center gap-2 w-full bg-red-50 text-red-600 font-bold py-3 rounded-xl hover:bg-red-100 transition">
                       <Phone size={18} className="animate-pulse" /> ê¸´ê¸‰ í†µí™”
                   </a>
               </div>

               {/* Quick Links Grid */}
               <div className="grid grid-cols-2 gap-3">
                  <QuickLink href="https://www.google.com/maps/search/?api=1&query=Lotte%20Mart%20Nha%20Trang" icon={<ShoppingBag className="text-red-500" size={24} />} label="ë¡¯ë°ë§ˆíŠ¸" />
                  <QuickLink href="https://www.google.com/maps/search/?api=1&query=VinWonders%20Nha%20Trang" icon={<LayoutGrid className="text-purple-500" size={24} />} label="ë¹ˆì›ë”ìŠ¤" />
                  <QuickLink href="https://www.google.com/maps/search/?api=1&query=Kim%20Chung%20Jewelry" icon={<CreditCard className="text-green-500" size={24} />} label="í™˜ì „(ê¹€ì²­)" />
                  <QuickLink href="https://www.google.com/maps/search/?api=1&query=Cong%20Caphe%20Nha%20Trang" icon={<Coffee className="text-amber-700" size={24} />} label="ì½©ì¹´í˜" />
               </div>

               {/* Personal Memo */}
               <div className="bg-white rounded-2xl p-5 border border-slate-100 shadow-sm">
                   <h3 className="font-bold text-slate-800 mb-3 flex items-center gap-2">
                     <Edit3 size={18} className="text-teal-600" /> ë‚˜ë§Œì˜ ë©”ëª¨ (ìë™ì €ì¥)
                   </h3>
                   <div className="relative">
                     <textarea 
                       value={userMemo}
                       onChange={handleMemoChange}
                       className="w-full h-40 bg-amber-50 rounded-xl p-4 text-sm text-slate-700 focus:outline-none focus:ring-2 focus:ring-amber-200 resize-none leading-relaxed placeholder-slate-400"
                       placeholder="ì—¬ê¸°ì— ììœ ë¡­ê²Œ ë©”ëª¨í•˜ì„¸ìš”.&#13;&#10;(ì˜ˆ: íƒì‹œë¹„ ê¸°ë¡, ë§ˆì‚¬ì§€ ì˜ˆì•½ì‹œê°„, ì‡¼í•‘ ë¦¬ìŠ¤íŠ¸)&#13;&#10;* ì•±ì„ êº¼ë„ ë‚´ìš©ì´ ì €ì¥ë©ë‹ˆë‹¤."
                     ></textarea>
                     <div className="absolute bottom-3 right-3 opacity-20 pointer-events-none">
                       <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgHfgIX70O5k6Anuo0UgALIdaG9jSga9auHu3uyz0uEirylGPAJnjN_qQbvEGMUvPqUQf_g9FMNUHRxlDcUBf4vZ3Mpy4TnA9WxbmzWYK11gt2zuy_Irl4wctNFjcjLyPo0GPXV792o_J7L9guRMuDfeC1gy7USwywjYbECZgzcsHybuGRRAXAnO1eNmP8/s320/logo.png" alt="logo" className="w-12 grayscale" />
                     </div>
                   </div>
               </div>
            </div>
          )}

        </section>

        {/* 5. Footer */}
        <footer className="bg-slate-900 text-white py-12 text-center">
            <div className="flex items-center justify-center gap-2 mb-4 opacity-80">
                <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgHfgIX70O5k6Anuo0UgALIdaG9jSga9auHu3uyz0uEirylGPAJnjN_qQbvEGMUvPqUQf_g9FMNUHRxlDcUBf4vZ3Mpy4TnA9WxbmzWYK11gt2zuy_Irl4wctNFjcjLyPo0GPXV792o_J7L9guRMuDfeC1gy7USwywjYbECZgzcsHybuGRRAXAnO1eNmP8/s320/logo.png" alt="Logo" className="h-6 w-auto grayscale brightness-200" />
                <span className="text-sm font-bold tracking-widest">TOURMAKER</span>
            </div>
            <p className="text-xs text-slate-500">Â© 2025 Taenggu's Family Trip. All rights reserved.</p>
        </footer>

        {/* Video Modal Overlay */}
        {showVideo && (
          <div className="fixed inset-0 z-50 bg-black/90 flex items-center justify-center p-4" onClick={() => setShowVideo(false)}>
            <div className="w-full max-w-3xl bg-black rounded-xl overflow-hidden shadow-2xl relative" onClick={e => e.stopPropagation()}>
              <button onClick={() => setShowVideo(false)} className="absolute top-2 right-2 text-white bg-black/50 rounded-full w-8 h-8 flex items-center justify-center z-10 hover:bg-black/80">
                <X size={20} />
              </button>
              <div className="relative pt-[56.25%]">
                <iframe 
                  className="absolute top-0 left-0 w-full h-full" 
                  src={videoUrl} 
                  title="YouTube video" 
                  frameBorder="0" 
                  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                  allowFullScreen
                ></iframe>
              </div>
            </div>
          </div>
        )}

        {/* Toast Notification */}
        <div className={`fixed bottom-8 left-1/2 transform -translate-x-1/2 bg-slate-800 text-white px-5 py-2.5 rounded-full text-sm shadow-xl transition-all duration-300 z-50 flex items-center gap-2 ${showToast ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-4 pointer-events-none'}`}>
           <CheckSquare size={16} className="text-teal-400" /> ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!
        </div>

      </main>
    </div>
  );
};

// --- Sub Components ---

const InfoBox = ({ icon, label, value }) => (
  <div className="bg-white/10 backdrop-blur-md rounded-xl p-3 border border-white/10 flex flex-col items-center justify-center h-full">
    <div className="text-teal-300 mb-1">{icon}</div>
    <span className="text-[10px] text-white/60 mb-0.5">{label}</span>
    <span className="text-xs font-bold leading-tight">{value}</span>
  </div>
);

const TabButton = ({ active, onClick, label }) => (
  <button 
    onClick={onClick}
    className={`flex-1 py-4 text-center border-b-2 transition-all duration-200 ${active ? 'border-teal-600 text-teal-600 bg-teal-50/50' : 'border-transparent hover:text-slate-600'}`}
  >
    {label}
  </button>
);

const HotelCard = ({ name, badge, badgeColor = "bg-blue-600", room, checkin, checkout, address, img, mapLink, tel, extraInfo }) => (
  <div className="bg-white rounded-2xl overflow-hidden shadow-sm border border-slate-100 group">
    <div className="h-40 bg-slate-200 relative overflow-hidden">
        <img src={img} alt={name} className="w-full h-full object-cover group-hover:scale-105 transition-transform duration-700" />
        <div className="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-4 pt-12">
            <span className={`${badgeColor} text-white text-[10px] font-bold px-2 py-1 rounded inline-block mb-1`}>{badge}</span>
            <h3 className="text-white font-bold text-lg leading-tight">{name}</h3>
        </div>
    </div>
    <div className="p-5">
        <div className="mb-4">
            <p className="text-xs font-bold text-slate-400 mb-1">ROOM TYPE</p>
            <p className="text-base font-black text-slate-800">{room}</p>
        </div>
        <div className="grid grid-cols-2 gap-3 text-sm mb-4">
            <div className="bg-slate-50 p-3 rounded-xl border border-slate-100 text-center">
                <p className="text-xs text-slate-500 mb-1">ì²´í¬ì¸</p>
                <p className="font-bold text-slate-900">{checkin}</p>
            </div>
            <div className="bg-slate-50 p-3 rounded-xl border border-slate-100 text-center">
                <p className="text-xs text-slate-500 mb-1">ì²´í¬ì•„ì›ƒ</p>
                <p className="font-bold text-slate-900">{checkout}</p>
            </div>
        </div>
        {extraInfo && (
            <div className="text-xs text-teal-800 bg-teal-50 p-3 rounded-xl mb-4 leading-relaxed border border-teal-100">
                <p className="font-bold mb-1 flex items-center gap-1"><CheckSquare size={12}/> í¬í•¨ ì‚¬í•­</p>
                <p>{extraInfo}</p>
            </div>
        )}
        <div className="flex gap-2">
            <a href={mapLink} target="_blank" rel="noreferrer" className="flex-1 flex items-center justify-center py-3 rounded-xl text-sm font-bold border border-slate-200 hover:bg-slate-50 transition text-slate-700">
                <MapPin size={16} className="mr-1" /> ì§€ë„
            </a>
            <a href={`tel:${tel}`} className="flex-1 flex items-center justify-center py-3 rounded-xl text-sm font-bold bg-teal-600 text-white hover:bg-teal-700 transition">
                <Phone size={16} className="mr-1" /> ì „í™”
            </a>
        </div>
    </div>
  </div>
);

const QuickLink = ({ href, icon, label }) => (
  <a href={href} target="_blank" rel="noreferrer" className="bg-white p-4 rounded-xl border border-slate-100 text-center hover:bg-slate-50 transition flex flex-col items-center justify-center gap-2 h-24">
      <div className="transform transition-transform hover:scale-110">{icon}</div>
      <p className="text-xs font-bold text-slate-700">{label}</p>
  </a>
);

export default App;
